(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";
function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
exports.__esModule = true;
__export(require("./World"));
__export(require("./math/Vec2"));
__export(require("./objects/Body"));
},{"./World":2,"./math/Vec2":3,"./objects/Body":4}],2:[function(require,module,exports){
"use strict";
exports.__esModule = true;
var Vec2_1 = require("./math/Vec2");
var World = /** @class */ (function () {
    function World() {
        this.bodies = new Array();
        this.gravity = new Vec2_1.Vec2(0, -50);
    }
    World.prototype.addBody = function (body) {
        this.bodies.push(body);
    };
    World.prototype.step = function (dt) {
        for (var _i = 0, _a = this.bodies; _i < _a.length; _i++) {
            var body = _a[_i];
            body.Integrate(dt);
        }
    };
    return World;
}());
exports.World = World;
},{"./math/Vec2":3}],3:[function(require,module,exports){
"use strict";
exports.__esModule = true;
/// 2D向量
var Vec2 = /** @class */ (function () {
    function Vec2(x, y) {
        if (x === void 0) { x = 0; }
        if (y === void 0) { y = 0; }
        this.x = x;
        this.y = y;
    }
    Vec2.prototype.Clone = function () {
        return new Vec2(this.x, this.y);
    };
    Vec2.prototype.SetZero = function () {
        this.x = 0;
        this.y = 0;
        return this;
    };
    Vec2.prototype.Set = function (x, y) {
        this.x = x;
        this.y = y;
        return this;
    };
    Vec2.prototype.Copy = function (other) {
        this.x = other.x;
        this.y = other.y;
        return this;
    };
    Vec2.prototype.SelfAdd = function (v) {
        this.x += v.x;
        this.y += v.y;
        return this;
    };
    Vec2.prototype.AddV = function (v) {
        return new Vec2(this.x + v.x, this.y + v.y);
    };
    Vec2.prototype.SelfSub = function (v) {
        this.x -= v.x;
        this.y -= v.y;
        return this;
    };
    Vec2.prototype.SubV = function (v) {
        return new Vec2(this.x - v.x, this.y - v.y);
    };
    Vec2.prototype.SelfMulS = function (s) {
        this.x *= s;
        this.y *= s;
        return this;
    };
    Vec2.prototype.MulS = function (s) {
        return new Vec2(this.x * s, this.y * s);
    };
    Vec2.prototype.Dot = function (v) {
        return this.x * v.x + this.y * v.y;
    };
    Vec2.prototype.CrossV = function (v) {
        return this.x * v.y - this.y * v.x;
    };
    Vec2.prototype.Length = function () {
        var x = this.x, y = this.y;
        return Math.sqrt(x * x + y * y);
    };
    Vec2.prototype.LengthSquared = function () {
        var x = this.x, y = this.y;
        return (x * x + y * y);
    };
    Vec2.prototype.Normalize = function () {
        //const length: number = this.Length();
        //if (length >= 0.001/*Setting.EPSILON*/) {
        var inv_length = 1 / this.Length();
        return new Vec2(this.x * inv_length, this.y * inv_length);
    };
    Vec2.prototype.SelfNormalize = function () {
        var length = this.Length();
        if (length >= 0.001 /*Setting.EPSILON*/) {
            var inv_length = 1 / length;
            this.x *= inv_length;
            this.y *= inv_length;
        }
        return this;
    };
    Vec2.prototype.SelfRotate = function (radians) {
        var c = Math.cos(radians);
        var s = Math.sin(radians);
        var x = this.x;
        this.x = c * x - s * this.y;
        this.y = s * x + c * this.y;
        return this;
    };
    Vec2.prototype.Rotate = function (radians) {
        var v_x = this.x, v_y = this.y;
        var c = Math.cos(radians);
        var s = Math.sin(radians);
        return new Vec2(c * v_x - s * v_y, s * v_x + c * v_y);
    };
    Vec2.prototype.SelfCrossVS = function (s) {
        var x = this.x;
        this.x = s * this.y;
        this.y = -s * x;
        return this;
    };
    Vec2.prototype.SelfCrossSV = function (s) {
        var x = this.x;
        this.x = -s * this.y;
        this.y = s * x;
        return this;
    };
    Vec2.prototype.SelfAbs = function () {
        this.x = Math.abs(this.x);
        this.y = Math.abs(this.y);
        return this;
    };
    Vec2.prototype.SelfNeg = function () {
        this.x = (-this.x);
        this.y = (-this.y);
        return this;
    };
    Vec2.prototype.Neg = function () {
        return new Vec2(-this.x, -this.y);
    };
    return Vec2;
}());
exports.Vec2 = Vec2;
},{}],4:[function(require,module,exports){
"use strict";
exports.__esModule = true;
var Vec2_1 = require("../math/Vec2");
var Body = /** @class */ (function () {
    /**
     * 刚体
     * @class Body
     * @constructor
     */
    function Body(world) {
        this.position = new Vec2_1.Vec2();
        this.velocity = new Vec2_1.Vec2();
        this.Acceleration = new Vec2_1.Vec2();
        this.world = world;
        //this.Acceleration.SelfAdd(world.Gravity);
    }
    Body.prototype.Integrate = function (dt) {
        // 在边界处反弹
        if (this.position.x < -280) {
            this.position.x = -280;
            this.velocity.x = -this.velocity.x;
        }
        else if (this.position.x > 280) {
            this.position.x = 280;
            this.velocity.x = -this.velocity.x;
        }
        if (this.position.y < -180) {
            this.position.y = -180;
            this.velocity.y = -this.velocity.y;
        }
        else if (this.position.y > 180) {
            this.position.y = 180;
            this.velocity.y = -this.velocity.y;
        }
        // 计算当前速度
        // 速度的该变量即加速度与时间的乘积
        // v+=a*t        
        this.velocity.SelfAdd(this.Acceleration.MulS(dt));
        this.position.SelfAdd(this.velocity.MulS(dt));
    };
    return Body;
}());
exports.Body = Body;
},{"../math/Vec2":3}],5:[function(require,module,exports){
"use strict";
exports.__esModule = true;
var sp = require("../src/StunPhysics");
var test = /** @class */ (function () {
    function test() {
        this.totalTime = 0; // 用于计算变加速运动的时间
        this.btnStart = document.getElementById('btnStart');
        this.rect = document.getElementById('rect');
        this.btnExample4 = document.getElementById('btnExample4');
        this.pMessage = document.getElementById('messageExample4');
        this.isPause = true;
        this.k = 50;
    }
    test.prototype.start = function () {
        var _this = this;
        this.btnStart.onclick = function () {
            _this.isPause = !_this.isPause;
            if (_this.isPause) {
                _this.btnStart.innerHTML = "开始";
                _this.btnExample4.disabled = true;
            }
            else {
                _this.btnStart.innerHTML = "暂停";
                _this.btnExample4.disabled = false;
            }
        };
        this.btnExample4.onclick = function () {
            _this.totalTime = 0;
            _this.circleBody.position.x = 0;
            _this.circleBody.velocity.x = 0;
        };
        this.world = new sp.World();
        this.circleBody = new sp.Body(this.world);
        this.ResetBody();
        this.world.addBody(this.circleBody);
        this.Update();
    };
    ;
    test.prototype.Update = function () {
        var _this = this;
        requestAnimationFrame(function () { return _this.Update(); });
        var time = Date.now();
        this.elapsedTime = this.previousTime ? (time - this.previousTime) / 1000 : 0;
        this.elapsedTime = Math.min(1 / 10, this.elapsedTime);
        this.previousTime = time;
        if (this.elapsedTime > 0) {
            var body = this.circleBody;
            if (!this.isPause) {
                //console.log('type=' + this.motionType + ',a=' + this.AccelerationLength + ',k=' + this.k);
                /*if (this.motionType == 0) {
                    body.Acceleration = this.world.Gravity;
                }
                else if (this.motionType == 1) {
                    body.Acceleration = body.velocity.Normalize().Rotate(Math.PI / 2).MulS(this.AccelerationLength);// 圆周运动
                }
                else if (this.motionType == 2) {
                    body.Acceleration = body.position.Neg().MulS(this.k);// 简谐振动
                }
                /*else if (this.motionType == 3) {
                    body.Acceleration.x = 5 - 0.9 * body.velocity.x;
                    this.totalTime += this.elapsedTime;
                    if (body.position.x <= 1.167) {
                        this.pMessage.innerText = "时间：" + this.totalTime + "s，位移：" + body.position.x + "m，速度：" + body.velocity.x+"m/s";
                    }
                }*/
                this.world.step(this.elapsedTime);
                this.rect.setAttribute("x", "30");
            }
        }
        ;
    };
    ;
    test.prototype.ResetBody = function () {
        this.circleBody.position.SetZero();
        this.circleBody.velocity.Set(100, 0);
    };
    return test;
}());
exports.test = test;
window.onload = function () {
    var main = new test();
    main.start();
};
},{"../src/StunPhysics":1}]},{},[5])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvU3R1blBoeXNpY3MudHMiLCJzcmMvV29ybGQudHMiLCJzcmMvbWF0aC9WZWMyLnRzIiwic3JjL29iamVjdHMvQm9keS50cyIsInRlc3QvYXBwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7QUNBQSw2QkFBd0I7QUFDeEIsaUNBQTRCO0FBQzVCLG9DQUErQjs7OztBQ0QvQixvQ0FBa0M7QUFFbEM7SUFLSTtRQUNJLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxLQUFLLEVBQVEsQ0FBQztRQUNoQyxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksV0FBSSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFRCx1QkFBTyxHQUFQLFVBQVEsSUFBVTtRQUNkLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUFFRCxvQkFBSSxHQUFKLFVBQUssRUFBVTtRQUNYLEtBQWlCLFVBQVcsRUFBWCxLQUFBLElBQUksQ0FBQyxNQUFNLEVBQVgsY0FBVyxFQUFYLElBQVcsRUFBRTtZQUF6QixJQUFJLElBQUksU0FBQTtZQUNULElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDdEI7SUFDTCxDQUFDO0lBQ0wsWUFBQztBQUFELENBbkJBLEFBbUJDLElBQUE7QUFuQlksc0JBQUs7Ozs7QUNIakIsUUFBUTtBQUNUO0lBS0ksY0FBWSxDQUFhLEVBQUUsQ0FBYTtRQUE1QixrQkFBQSxFQUFBLEtBQWE7UUFBRSxrQkFBQSxFQUFBLEtBQWE7UUFDcEMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDWCxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNmLENBQUM7SUFFRCxvQkFBSyxHQUFMO1FBQ0ksT0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMs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QyxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFDTCxXQUFDO0FBQUQsQ0FuR0EsQUFtR0MsSUFBQTtBQW5HWSxvQkFBSTtBQXFHakIsTUFBTSxDQUFDLE1BQU0sR0FBRztJQUNaLElBQUksSUFBSSxHQUFTLElBQUksSUFBSSxFQUFFLENBQUM7SUFDNUIsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO0FBQ2pCLENBQUMsQ0FBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImV4cG9ydCAqIGZyb20gXCIuL1dvcmxkXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL21hdGgvVmVjMlwiO1xyXG5leHBvcnQgKiBmcm9tIFwiLi9vYmplY3RzL0JvZHlcIjsiLCJpbXBvcnQgeyBCb2R5IH0gZnJvbSBcIi4vb2JqZWN0cy9Cb2R5XCI7XHJcbmltcG9ydCB7IFZlYzIgfSBmcm9tIFwiLi9tYXRoL1ZlYzJcIlxyXG5cclxuZXhwb3J0IGNsYXNzIFdvcmxkIHtcclxuXHJcbiAgICBncmF2aXR5OiBWZWMyO1xyXG4gICAgYm9kaWVzOiBBcnJheTxCb2R5PjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmJvZGllcyA9IG5ldyBBcnJheTxCb2R5PigpO1xyXG4gICAgICAgIHRoaXMuZ3Jhdml0eSA9IG5ldyBWZWMyKDAsIC01MCk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkQm9keShib2R5OiBCb2R5KSB7XHJcbiAgICAgICAgdGhpcy5ib2RpZXMucHVzaChib2R5KTtcclxuICAgIH1cclxuXHJcbiAgICBzdGVwKGR0OiBudW1iZXIpIHtcclxuICAgICAgICBmb3IgKGxldCBib2R5IG9mIHRoaXMuYm9kaWVzKSB7ICAgIFxyXG4gICAgICAgICAgICBib2R5LkludGVncmF0ZShkdCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59Iiwi77u/Ly8vIDJE5ZCR6YePXHJcbmV4cG9ydCBjbGFzcyBWZWMyIHtcclxuICAgIFxyXG4gICAgeDogbnVtYmVyO1xyXG4gICAgeTogbnVtYmVyO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHg6IG51bWJlciA9IDAsIHk6IG51bWJlciA9IDApIHtcclxuICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICB9XHJcblxyXG4gICAgQ2xvbmUoKTogVmVjMiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMyKHRoaXMueCwgdGhpcy55KTtcclxuICAgIH1cclxuXHJcbiAgICBTZXRaZXJvKCk6IFZlYzIge1xyXG4gICAgICAgIHRoaXMueCA9IDA7XHJcbiAgICAgICAgdGhpcy55ID0gMDtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBTZXQoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBWZWMyIHtcclxuICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgQ29weShvdGhlcjogVmVjMik6IFZlYzIge1xyXG4gICAgICAgIHRoaXMueCA9IG90aGVyLng7XHJcbiAgICAgICAgdGhpcy55ID0gb3RoZXIueTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBTZWxmQWRkKHY6IFZlYzIpOiBWZWMyIHtcclxuICAgICAgICB0aGlzLnggKz0gdi54O1xyXG4gICAgICAgIHRoaXMueSArPSB2Lnk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgQWRkVih2OiBWZWMyKTogVmVjMiB7ICAgICAgICBcclxuICAgICAgICByZXR1cm4gbmV3IFZlYzIodGhpcy54ICsgdi54LHRoaXMueSArIHYueSk7XHJcbiAgICB9XHJcblxyXG4gICAgU2VsZlN1Yih2OiBWZWMyKTogVmVjMiB7XHJcbiAgICAgICAgdGhpcy54IC09IHYueDtcclxuICAgICAgICB0aGlzLnkgLT0gdi55O1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIFN1YlYodjogVmVjMik6IFZlYzIge1xyXG4gICAgICAgIHJldHVybiBuZXcgVmVjMih0aGlzLnggLSB2LngsdGhpcy55IC0gdi55KTsgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIFNlbGZNdWxTKHM6IG51bWJlcik6IFZlYzIge1xyXG4gICAgICAgIHRoaXMueCAqPSBzO1xyXG4gICAgICAgIHRoaXMueSAqPSBzO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIE11bFMoczogbnVtYmVyKTogVmVjMiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMyKHRoaXMueCAqIHMsIHRoaXMueSAqIHMpO1xyXG4gICAgfVxyXG5cclxuICAgIERvdCh2OiBWZWMyKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy54ICogdi54ICsgdGhpcy55ICogdi55O1xyXG4gICAgfVxyXG5cclxuICAgIENyb3NzVih2OiBWZWMyKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy54ICogdi55IC0gdGhpcy55ICogdi54O1xyXG4gICAgfVxyXG5cclxuICAgIExlbmd0aCgpOiBudW1iZXIge1xyXG4gICAgICAgIGNvbnN0IHg6IG51bWJlciA9IHRoaXMueCwgeTogbnVtYmVyID0gdGhpcy55O1xyXG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSk7XHJcbiAgICB9XHJcblxyXG4gICAgTGVuZ3RoU3F1YXJlZCgpOiBudW1iZXIge1xyXG4gICAgICAgIGNvbnN0IHg6IG51bWJlciA9IHRoaXMueCwgeTogbnVtYmVyID0gdGhpcy55O1xyXG4gICAgICAgIHJldHVybiAoeCAqIHggKyB5ICogeSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIE5vcm1hbGl6ZSgpOiBWZWMyIHtcclxuICAgICAgICAvL2NvbnN0IGxlbmd0aDogbnVtYmVyID0gdGhpcy5MZW5ndGgoKTtcclxuICAgICAgICAgICAgICAgIC8vaWYgKGxlbmd0aCA+PSAwLjAwMS8qU2V0dGluZy5FUFNJTE9OKi8pIHtcclxuICAgICAgICAgY29uc3QgaW52X2xlbmd0aDogbnVtYmVyID0gMSAvIHRoaXMuTGVuZ3RoKCk7XHJcbiAgICAgICAgIHJldHVybiBuZXcgVmVjMih0aGlzLngqaW52X2xlbmd0aCx0aGlzLnkqaW52X2xlbmd0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFNlbGZOb3JtYWxpemUoKTogVmVjMiB7XHJcbiAgICAgICAgY29uc3QgbGVuZ3RoOiBudW1iZXIgPSB0aGlzLkxlbmd0aCgpO1xyXG4gICAgICAgIGlmIChsZW5ndGggPj0gMC4wMDEvKlNldHRpbmcuRVBTSUxPTiovKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGludl9sZW5ndGg6IG51bWJlciA9IDEgLyBsZW5ndGg7XHJcbiAgICAgICAgICAgIHRoaXMueCAqPSBpbnZfbGVuZ3RoO1xyXG4gICAgICAgICAgICB0aGlzLnkgKj0gaW52X2xlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFNlbGZSb3RhdGUocmFkaWFuczogbnVtYmVyKTogVmVjMiB7XHJcbiAgICAgICAgY29uc3QgYzogbnVtYmVyID0gTWF0aC5jb3MocmFkaWFucyk7XHJcbiAgICAgICAgY29uc3QgczogbnVtYmVyID0gTWF0aC5zaW4ocmFkaWFucyk7XHJcbiAgICAgICAgY29uc3QgeDogbnVtYmVyID0gdGhpcy54O1xyXG4gICAgICAgIHRoaXMueCA9IGMgKiB4IC0gcyAqIHRoaXMueTtcclxuICAgICAgICB0aGlzLnkgPSBzICogeCArIGMgKiB0aGlzLnk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgUm90YXRlKHJhZGlhbnM6IG51bWJlcik6IFZlYzIge1xyXG4gICAgICAgIGNvbnN0IHZfeDogbnVtYmVyID0gdGhpcy54LCB2X3k6IG51bWJlciA9IHRoaXMueTtcclxuICAgICAgICBjb25zdCBjOiBudW1iZXIgPSBNYXRoLmNvcyhyYWRpYW5zKTtcclxuICAgICAgICBjb25zdCBzOiBudW1iZXIgPSBNYXRoLnNpbihyYWRpYW5zKTtcclxuICAgICAgICByZXR1cm4gbmV3IFZlYzIoYyAqIHZfeCAtIHMgKiB2X3kscyAqIHZfeCArIGMgKiB2X3kpO1xyXG4gICAgfVxyXG5cclxuICAgIFNlbGZDcm9zc1ZTKHM6IG51bWJlcik6IFZlYzIge1xyXG4gICAgICAgIGNvbnN0IHg6IG51bWJlciA9IHRoaXMueDtcclxuICAgICAgICB0aGlzLnggPSBzICogdGhpcy55O1xyXG4gICAgICAgIHRoaXMueSA9IC1zICogeDtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBTZWxmQ3Jvc3NTVihzOiBudW1iZXIpOiBWZWMyIHtcclxuICAgICAgICBjb25zdCB4OiBudW1iZXIgPSB0aGlzLng7XHJcbiAgICAgICAgdGhpcy54ID0gLXMgKiB0aGlzLnk7XHJcbiAgICAgICAgdGhpcy55ID0gcyAqIHg7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgU2VsZkFicygpOiBWZWMyIHtcclxuICAgICAgICB0aGlzLnggPSBNYXRoLmFicyh0aGlzLngpO1xyXG4gICAgICAgIHRoaXMueSA9IE1hdGguYWJzKHRoaXMueSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgU2VsZk5lZygpOiBWZWMyIHtcclxuICAgICAgICB0aGlzLnggPSAoLXRoaXMueCk7XHJcbiAgICAgICAgdGhpcy55ID0gKC10aGlzLnkpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBOZWcoKTogVmVjMiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWMyKC10aGlzLngsLXRoaXMueSk7XHJcbiAgICB9ICAgIFxyXG59Iiwi77u/aW1wb3J0IHsgVmVjMiB9IGZyb20gXCIuLi9tYXRoL1ZlYzJcIjtcclxuaW1wb3J0IHsgV29ybGQgfSBmcm9tIFwiLi4vV29ybGRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBCb2R5IHtcclxuXHJcbiAgICBwb3NpdGlvbjogVmVjMiA9IG5ldyBWZWMyKCk7XHJcbiAgICB2ZWxvY2l0eTogVmVjMiA9IG5ldyBWZWMyKCk7XHJcbiAgICBBY2NlbGVyYXRpb246IFZlYzIgPSBuZXcgVmVjMigpO1xyXG5cclxuICAgIHdvcmxkOiBXb3JsZDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOWImuS9k1xyXG4gICAgICogQGNsYXNzIEJvZHlcclxuICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcih3b3JsZDogV29ybGQpIHtcclxuICAgICAgICB0aGlzLndvcmxkID0gd29ybGQ7XHJcbiAgICAgICAgLy90aGlzLkFjY2VsZXJhdGlvbi5TZWxmQWRkKHdvcmxkLkdyYXZpdHkpO1xyXG4gICAgfVxyXG5cclxuICAgIEludGVncmF0ZShkdDogbnVtYmVyKSB7XHJcblxyXG4gICAgICAgIC8vIOWcqOi+ueeVjOWkhOWPjeW8uVxyXG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnggPCAtMjgwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueCA9IC0yODA7XHJcbiAgICAgICAgICAgIHRoaXMudmVsb2NpdHkueCA9IC10aGlzLnZlbG9jaXR5Lng7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMucG9zaXRpb24ueCA+IDI4MCkge1xyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnggPSAyODA7XHJcbiAgICAgICAgICAgIHRoaXMudmVsb2NpdHkueCA9IC10aGlzLnZlbG9jaXR5Lng7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnkgPCAtMTgwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueSA9IC0xODA7XHJcbiAgICAgICAgICAgIHRoaXMudmVsb2NpdHkueSA9IC10aGlzLnZlbG9jaXR5Lnk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMucG9zaXRpb24ueSA+IDE4MCkge1xyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnkgPSAxODA7XHJcbiAgICAgICAgICAgIHRoaXMudmVsb2NpdHkueSA9IC10aGlzLnZlbG9jaXR5Lnk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDorqHnrpflvZPliY3pgJ/luqZcclxuICAgICAgICAvLyDpgJ/luqbnmoTor6Xlj5jph4/ljbPliqDpgJ/luqbkuI7ml7bpl7TnmoTkuZjnp69cclxuICAgICAgICAvLyB2Kz1hKnQgICAgICAgIFxyXG4gICAgICAgIHRoaXMudmVsb2NpdHkuU2VsZkFkZCh0aGlzLkFjY2VsZXJhdGlvbi5NdWxTKGR0KSk7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbi5TZWxmQWRkKHRoaXMudmVsb2NpdHkuTXVsUyhkdCkpO1xyXG4gICAgfVxyXG5cclxufSAgICIsIu+7v1xyXG5pbXBvcnQgKiBhcyBzcCBmcm9tIFwiLi4vc3JjL1N0dW5QaHlzaWNzXCJcclxuaW1wb3J0IHsgcmVqZWN0cyB9IGZyb20gXCJhc3NlcnRcIjtcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgdGVzdCB7XHJcblxyXG4gICAgd29ybGQ6IHNwLldvcmxkO1xyXG4gICAgY2lyY2xlQm9keTogc3AuQm9keTtcclxuXHJcbiAgICBpc1BhdXNlOiBib29sZWFuO1xyXG4gICAgYnRuU3RhcnQ6IEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgYnRuRXhhbXBsZTQ6IEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgcmVjdDpIVE1MRWxlbWVudDtcclxuICAgIHBNZXNzYWdlOiBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuXHJcbiAgICBBY2NlbGVyYXRpb25MZW5ndGg6IG51bWJlcjtcclxuICAgIGs6IG51bWJlcjtcclxuXHJcbiAgICBwdWJsaWMgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIHRoaXMuYnRuU3RhcnQgPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0blN0YXJ0Jyk7XHJcbiAgICAgICAgdGhpcy5yZWN0PTxIVE1MRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVjdCcpO1xyXG4gICAgICAgIHRoaXMuYnRuRXhhbXBsZTQgPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bkV4YW1wbGU0Jyk7XHJcbiAgICAgICAgdGhpcy5wTWVzc2FnZSA9IDxIVE1MUGFyYWdyYXBoRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVzc2FnZUV4YW1wbGU0Jyk7XHJcblxyXG4gICAgICAgIHRoaXMuaXNQYXVzZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5rID0gNTA7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhcnQoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuYnRuU3RhcnQub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5pc1BhdXNlID0gIXRoaXMuaXNQYXVzZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNQYXVzZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydC5pbm5lckhUTUwgPSBcIuW8gOWni1wiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idG5FeGFtcGxlNC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0LmlubmVySFRNTCA9IFwi5pqC5YGcXCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ0bkV4YW1wbGU0LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYnRuRXhhbXBsZTQub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy50b3RhbFRpbWUgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmNpcmNsZUJvZHkucG9zaXRpb24ueCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuY2lyY2xlQm9keS52ZWxvY2l0eS54ID0gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMud29ybGQgPSBuZXcgc3AuV29ybGQoKTtcclxuICAgICAgICB0aGlzLmNpcmNsZUJvZHkgPSBuZXcgc3AuQm9keSh0aGlzLndvcmxkKTtcclxuICAgICAgICB0aGlzLlJlc2V0Qm9keSgpO1xyXG4gICAgICAgIHRoaXMud29ybGQuYWRkQm9keSh0aGlzLmNpcmNsZUJvZHkpO1xyXG5cclxuICAgICAgICB0aGlzLlVwZGF0ZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBwcmV2aW91c1RpbWU6IG51bWJlcjsgICAgICAgICAvLyDkuIrkuIDluKfnmoTlvIDlp4vml7bliLtcclxuICAgIGVsYXBzZWRUaW1lOiBudW1iZXI7ICAgICAgICAgIC8vIOavj+W4p+a1gemAneeahOaXtumXtO+8iOavq+enku+8iVxyXG4gICAgdG90YWxUaW1lOiBudW1iZXIgPSAwOyAgICAgICAgLy8g55So5LqO6K6h566X5Y+Y5Yqg6YCf6L+Q5Yqo55qE5pe26Ze0XHJcblxyXG4gICAgVXBkYXRlKCkge1xyXG5cclxuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gdGhpcy5VcGRhdGUoKSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRpbWU6IG51bWJlciA9IERhdGUubm93KCk7XHJcbiAgICAgICAgdGhpcy5lbGFwc2VkVGltZSA9IHRoaXMucHJldmlvdXNUaW1lID8gKHRpbWUgLSB0aGlzLnByZXZpb3VzVGltZSkgLyAxMDAwIDogMDtcclxuICAgICAgICB0aGlzLmVsYXBzZWRUaW1lID0gTWF0aC5taW4oMSAvIDEwLCB0aGlzLmVsYXBzZWRUaW1lKTtcclxuICAgICAgICB0aGlzLnByZXZpb3VzVGltZSA9IHRpbWU7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmVsYXBzZWRUaW1lID4gMCkge1xyXG5cclxuICAgICAgICAgICAgbGV0IGJvZHk6IHNwLkJvZHkgPSB0aGlzLmNpcmNsZUJvZHk7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1BhdXNlKSB7XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCd0eXBlPScgKyB0aGlzLm1vdGlvblR5cGUgKyAnLGE9JyArIHRoaXMuQWNjZWxlcmF0aW9uTGVuZ3RoICsgJyxrPScgKyB0aGlzLmspO1xyXG4gICAgICAgICAgICAgICAgLyppZiAodGhpcy5tb3Rpb25UeXBlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBib2R5LkFjY2VsZXJhdGlvbiA9IHRoaXMud29ybGQuR3Jhdml0eTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMubW90aW9uVHlwZSA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9keS5BY2NlbGVyYXRpb24gPSBib2R5LnZlbG9jaXR5Lk5vcm1hbGl6ZSgpLlJvdGF0ZShNYXRoLlBJIC8gMikuTXVsUyh0aGlzLkFjY2VsZXJhdGlvbkxlbmd0aCk7Ly8g5ZyG5ZGo6L+Q5YqoXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLm1vdGlvblR5cGUgPT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgIGJvZHkuQWNjZWxlcmF0aW9uID0gYm9keS5wb3NpdGlvbi5OZWcoKS5NdWxTKHRoaXMuayk7Ly8g566A6LCQ5oyv5YqoXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvKmVsc2UgaWYgKHRoaXMubW90aW9uVHlwZSA9PSAzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9keS5BY2NlbGVyYXRpb24ueCA9IDUgLSAwLjkgKiBib2R5LnZlbG9jaXR5Lng7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbFRpbWUgKz0gdGhpcy5lbGFwc2VkVGltZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYm9keS5wb3NpdGlvbi54IDw9IDEuMTY3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucE1lc3NhZ2UuaW5uZXJUZXh0ID0gXCLml7bpl7TvvJpcIiArIHRoaXMudG90YWxUaW1lICsgXCJz77yM5L2N56e777yaXCIgKyBib2R5LnBvc2l0aW9uLnggKyBcIm3vvIzpgJ/luqbvvJpcIiArIGJvZHkudmVsb2NpdHkueCtcIm0vc1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0qL1xyXG4gICAgICAgICAgICAgICAgdGhpcy53b3JsZC5zdGVwKHRoaXMuZWxhcHNlZFRpbWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN0LnNldEF0dHJpYnV0ZShcInhcIixcIjMwXCIpO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIFJlc2V0Qm9keSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNpcmNsZUJvZHkucG9zaXRpb24uU2V0WmVybygpO1xyXG4gICAgICAgIHRoaXMuY2lyY2xlQm9keS52ZWxvY2l0eS5TZXQoMTAwLCAwKTtcclxuICAgIH1cclxufVxyXG5cclxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcclxuICAgIHZhciBtYWluOiB0ZXN0ID0gbmV3IHRlc3QoKTtcclxuICAgIG1haW4uc3RhcnQoKTtcclxufSJdfQ==
